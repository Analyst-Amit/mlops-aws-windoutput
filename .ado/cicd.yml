# Azure DevOps pipeline with MaxConcurrency set to 1

trigger:
  branches:
    include:
      - main

pool:
  name: MVSLocalPool

jobs:
- job: BuildAndTest
  displayName: 'Build and Test Job'

  steps:
    - checkout: self
      displayName: 'Checkout source code'

    - task: UsePythonVersion@0
      inputs:
        versionSpec: '3.10.12'
        addToPath: true
      displayName: 'Set up Python'
      env:
        GITHUB_TOKEN: $(GITHUB_TOKEN)

    - script: |
        pip install tox==4.20.0
      displayName: 'Install tox version 4.20.0'

    - script: |
        tox
      displayName: 'Run tests with tox'
